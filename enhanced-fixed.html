<!DOCTYPE html>
<html>
<head>
    <title>Sydney Rent - FIXED</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 20px; font-family: Arial; background: #f5f5f5; }
        #map { height: 600px; width: 100%; border: 3px solid #333; border-radius: 10px; }
        h1 { text-align: center; color: #333; }
        .status { text-align: center; padding: 20px; background: white; border-radius: 10px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>✅ Sydney Rent Map - FIXED VERSION</h1>
    
    <div class="status" id="status">Loading enhanced map...</div>
    
    <div id="map"></div>
    
    <!-- LOAD IN CORRECT ORDER -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="data.js"></script>
    
    <script>
        // WAIT for data.js to load
        window.addEventListener('load', function() {
            console.log('=== FIXED VERSION START ===');
            console.log('Data loaded?', typeof sydneySuburbs !== 'undefined');
            
            if (!window.sydneySuburbs) {
                document.getElementById('status').innerHTML = 
                    '<span style="color:red">❌ ERROR: data.js not loaded</span>';
                return;
            }
            
            console.log('SUCCESS! Data:', sydneySuburbs.length, 'suburbs');
            
            // CREATE MAP
            const map = L.map('map').setView([-33.8688, 151.2093], 11);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            
            // ADD ENHANCED MARKERS
            sydneySuburbs.forEach((suburb, index) => {
                const colors = ['#4CAF50', '#2196F3', '#FF9800'];
                const color = colors[index % colors.length];
                
                const icon = L.divIcon({
                    html: `<div style="background:${color};width:30px;height:30px;border-radius:50%;border:4px solid white;box-shadow:0 3px 10px rgba(0,0,0,0.3);"></div>`
                });
                
                L.marker([suburb.lat, suburb.lng], { icon })
                    .addTo(map)
                    .bindPopup(`
                        <div style="min-width:200px;">
                            <h3 style="color:${color}">${suburb.name}</h3>
                            <p><strong>Marker ${index + 1}</strong></p>
                            <p>Lat: ${suburb.lat.toFixed(4)}</p>
                            <p>Lng: ${suburb.lng.toFixed(4)}</p>
                        </div>
                    `);
            });
            
            document.getElementById('status').innerHTML = 
                `<span style="color:green">✅ SUCCESS! Showing ${sydneySuburbs.length} enhanced markers</span>`;
            
            console.log('=== FIXED VERSION COMPLETE ===');
        });
    </script>
</body>
</html>